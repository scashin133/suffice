<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Frameset//EN""http://www.w3.org/TR/REC-html40/frameset.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc on Tue Jan 21 17:22:12 CET 2003 -->
<TITLE>
Jeks: Class  FunctionParser
</TITLE>
<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">
</HEAD>
<BODY BGCOLOR="white">

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_top"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<A HREF='http://www.eteks.com'><FONT SIZE='+1'>http://www.eteks.com</FONT></A></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../com/eteks/parser/ExpressionParser.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../com/eteks/parser/JavaSyntax.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="FunctionParser.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.eteks.parser</FONT>
<BR>
Class  FunctionParser</H2>
<PRE>
java.lang.Object
  |
  +--<A HREF="../../../com/eteks/parser/Parser.html">com.eteks.parser.Parser</A>
        |
        +--<B>com.eteks.parser.FunctionParser</B>
</PRE>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../../com/eteks/parser/ExpressionParser.html">ExpressionParser</A>, <A HREF="../../../com/eteks/jeks/JeksFunctionParser.html">JeksFunctionParser</A></DD>
</DL>
<HR>
<DL>
<DT>public class <B>FunctionParser</B><DT>extends <A HREF="../../../com/eteks/parser/Parser.html">Parser</A></DL>

<P>
Parser able to compile functions with parameters of the form
 <i>function (list of parameters) = expression operating on parameters</i>.
 The <i>expression</i> may contain unary or binary operators, conditions, common functions
 or other functions operating on literals, constants and paramaters of the function.<br>
 A parser is associated to a syntax, instance of the <code>Syntax</code> interface that
 describes the different lexicals used by the parser and their type.<br>
 The <code>CompiledFunction compileFunction (String functionDefinition)</code> method
 of this class allows to parse and compile the definition <code>functionDefinition</code>
 of a function, that must be made of the following elements :
 <UL><LI>The <i>function</i> name and its parameters must be strings
         validated by the <code>isValidIdentifier ()</code> method of the syntax of the parser.
         These strings mustn't be reserved words of the syntax of the parser, i.e.
         <code>getLiteral ()</code>, <code>getConstantKey ()</code>,
         <code>getUnaryOperatorKey ()</code>, <code>getBinaryOperatorKey ()</code>,
         <code>getConditionPartKey ()</code> and <code>getCommonFunctionKey ()</code> methods of the syntax
         must return <code>null</code> for these strings. The name of the function mustn't also be
         a function already defined by the syntax (the <code>getFunction ()</code> method
         of the syntax must return <code>null</code> for the name of the function).</LI>
     <LI>The <i>list of parameters</i> may contain as many parameters as needed by the
         expression, separated by the character returned by the <code>getParameterSeparator ()</code> method
         of the syntax. This list may be empty and must be bracketed between the characters
         returned by <code>getOpeningBracket ()</code> and <code>getClosingBracket ()</code> methods
         of the syntax.</LI>
     <LI>The declaration of the function and its parameters must be followed by the operator
         of assignment returned by the <code>getAssignmentOperator ()</code> method of the syntax.</LI>
     <LI>Following the operator of assignment is the expression of the function that
         describes the operations to apply to the parameters, using the following
         syntactic elements :
         <UL><LI>literals (numbers, quoted strings) accepted by the <code>getLiteral ()</code> method of the syntax</LI>
             <LI>constants (PI true false ...) accepted by the <code>getConstantKey ()</code> method of the syntax</LI>
             <LI>unary operators(- ! ...) accepted by the <code>getUnaryOperatorKey ()</code> method of the syntax</LI>
             <LI>binary operators (- + / ...) accepted by the <code>getBinaryOperatorKey ()</code> method of the syntax
                 and whose priority is returned by the <code>getBinaryOperatorPriority ()</code> method</LI>
             <LI>conditions whose parts (? :) are accepted by the <code>getConditionPartKey ()</code> method of the syntax</LI>
             <LI>common functions (log sin ...) accepted by the <code>getCommonFunctionKey ()</code> method of the syntax</LI>
             <LI>other functions accepted by the <code>getFunction ()</code> method of the syntax.
                 Parameters passed to functions must be bracketed between the characters
                 returned by <code>getOpeningBracket ()</code> and <code>getClosingBracket ()</code>
                 methods of the syntax, and separated by the character returned by the
                 <code>getParameterSeparator ()</code> method.
                 These functions are instances of classes implementing the
                 <code>Function</code> interface. They may be classes written in Java or functions
                 compiled previously with a parser (the <code>CompiledFunction</code> class
                 implements <code>Function</code>).</LI></UL>
         As the function may call itself recursively or call functions compiled previously,
         users may create any kind of computer operations (in the limit of the stack).
         Binary operators processed by this parser are infixed, unary operators and functions
         are prefixed. Some parts of the expression may be bracketed between the characters
         returned by <code>getOpeningBracket ()</code> and <code>getClosingBracket ()</code> methods.</LI></UL>

 White spaces returned by the <code>getWhiteSpaceCharacters ()</code> method
 of the syntax may be used anywhere in the definition of the function.<br>
 If the <code>compileFunction ()</code> method fails to compile a definition,
 it throws a <code>CompilationException</code> exception
 that describe the found error (syntax error or other error).<br>
 Once a funtion is compiled, the <code>computeFunction ()</code> methods available for the
 returned object allow to compute its value according to the value of the parameters
 passed to them.

 <P>Here are a few examples of functions that can be compiled with this parser :
 <BLOCKQUOTE><PRE> // Create a parser with the syntax <code>PascalSyntax</code>
 FunctionParser parser = new FunctionParser (new PascalSyntax ());

 // Compile functions with this parser
 CompiledFunction f = parser.<b>compileFunction</b> ("F(x) = x * LN (x)");
 CompiledFunction fact = parser.<b>compileFunction</b> ("FACT(x) = IF x <= 0 THEN 1 ELSE x * FACT (x - 1)");
 CompiledFunction cotan = parser.<b>compileFunction</b> ("COTAN(x) = 1 / TAN (x)");
 // Add function cotan to be able to use it in other functions
 ((PascalSyntax)parser.getSyntax ()).addFunction (cotan);
 CompiledFunction f4 = parser.<b>compileFunction</b> ("F4(x,y,z) = 5.1E-1 * COTAN (X) * COTAN (Y) * COTAN (Z)");

 // Compute functions with double values
 double r1 = f.<b>computeFunction</b> (new double [] {2.1});
 double fact10 = fact.<b>computeFunction</b> (new double [] {10});
 // Compute the 100 value of cotan between 0 and Math.PI
 double cotanValues [] = new double [100];
 double cotanParam  [] = new double [1];
 for (int i = 0; i < cotanValues.length; i++)
 {
   // Use the same table for parameters to avoid useless creations of table
   cotanParam  [0] = Math.PI / i;
   cotanValues [i] = cotan.<b>computeFunction</b> (cotanParam).doubleValue ();
 }
 double r4 = f4.<b>computeFunction</b> (new double [] {1, 3, 3});</PRE></BLOCKQUOTE>

 The methods of this class are thread safe.
<P>
<DL>
<DT><B>Since: </B><DD>Jeks 1.0</DD>
<DT><B>Version: </B><DD>1.0.2</DD>
<DT><B>Author: </B><DD>Emmanuel Puybaret</DD>
<DT><B>See Also: </B><DD><A HREF="../../../com/eteks/parser/Syntax.html"><CODE>Syntax</CODE></A>, 
<A HREF="../../../com/eteks/parser/Function.html"><CODE>Function</CODE></A>, 
<A HREF="../../../com/eteks/parser/CompiledFunction.html"><CODE>CompiledFunction</CODE></A></DL>
<HR>

<P>
<!-- ======== INNER CLASS SUMMARY ======== -->


<!-- =========== FIELD SUMMARY =========== -->


<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../com/eteks/parser/FunctionParser.html#FunctionParser()">FunctionParser</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a parser for functions whose syntax is an instance of <code>DefaultSyntax</code>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../com/eteks/parser/FunctionParser.html#FunctionParser(com.eteks.parser.Syntax)">FunctionParser</A></B>(<A HREF="../../../com/eteks/parser/Syntax.html">Syntax</A>&nbsp;syntax)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a parser for functions with the syntax <code>syntax</code>.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/eteks/parser/CompiledFunction.html">CompiledFunction</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/eteks/parser/FunctionParser.html#compileFunction(java.lang.String)">compileFunction</A></B>(java.lang.String&nbsp;functionDefinition)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compiles the definition of a function <code>functionDefinition</code> and
 returns the instance of <code>CompiledFunction</code> matching the definition.
 </TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/eteks/parser/Syntax.html">Syntax</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/eteks/parser/FunctionParser.html#getSyntax()">getSyntax</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns the syntax used by this parser.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->


<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="FunctionParser()"><!-- --></A><H3>
FunctionParser</H3>
<PRE>
public <B>FunctionParser</B>()</PRE>
<DL>
<DD>Creates a parser for functions whose syntax is an instance of <code>DefaultSyntax</code>.</DL>
<HR>

<A NAME="FunctionParser(com.eteks.parser.Syntax)"><!-- --></A><H3>
FunctionParser</H3>
<PRE>
public <B>FunctionParser</B>(<A HREF="../../../com/eteks/parser/Syntax.html">Syntax</A>&nbsp;syntax)</PRE>
<DL>
<DD>Creates a parser for functions with the syntax <code>syntax</code>.<DD><DL>
<DT><B>Parameters:</B><DD><CODE>syntax</CODE> - syntax of the parser.</DL>
</DD>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" CELLPADDING="3" CELLSPACING="0" WIDTH="100%">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="getSyntax()"><!-- --></A><H3>
getSyntax</H3>
<PRE>
public <A HREF="../../../com/eteks/parser/Syntax.html">Syntax</A> <B>getSyntax</B>()</PRE>
<DL>
<DD>Returns the syntax used by this parser.<DD><DL>
<DT><B>Returns:</B><DD>the syntax of the parser.</DL>
</DD>
</DL>
<HR>

<A NAME="compileFunction(java.lang.String)"><!-- --></A><H3>
compileFunction</H3>
<PRE>
public <A HREF="../../../com/eteks/parser/CompiledFunction.html">CompiledFunction</A> <B>compileFunction</B>(java.lang.String&nbsp;functionDefinition)
                                 throws <A HREF="../../../com/eteks/parser/CompilationException.html">CompilationException</A></PRE>
<DL>
<DD>Compiles the definition of a function <code>functionDefinition</code> and
 returns the instance of <code>CompiledFunction</code> matching the definition.
 This method builds a tree of type <code>ExpressionNode</code> matching the expression
 of the function. This tree is used to compute the value of a function at interpretation time.<DD><DL>
<DT><B>Parameters:</B><DD><CODE>functionDefinition</CODE> - the definition of the function.<DT><B>Returns:</B><DD>an instance of <code>CompiledFunction</code>, with which values can be computed.<DT><B>Throws:</B><DD><CODE><A HREF="../../../com/eteks/parser/CompilationException.html">CompilationException</A></CODE> - if the syntax of the function is incorrect or if some
         elements (literals, constants, operators, functions,...) of its expression are not
         accepted by the syntax of the parser.</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>

<!-- ========== START OF NAVBAR ========== -->
<A NAME="navbar_bottom"><!-- --></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
<P><CENTER>&cp; 1998-2003 eTeks - All rights reserved</CENTER></EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../com/eteks/parser/ExpressionParser.html"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../com/eteks/parser/JavaSyntax.html"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html" TARGET="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="FunctionParser.html" TARGET="_top"><B>NO FRAMES</B></A></FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY: &nbsp;INNER&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL: &nbsp;FIELD&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<!-- =========== END OF NAVBAR =========== -->

<HR>

</BODY>
</HTML>
